%Limits of the Oceanic regions, acquired graphically from Nowicki's paper
% Be careful, long here is between -330 and 30 because of graphic
% limitations, correct this below

Lim_NP = [-238.39779005524858, 23.16455696202531
-234.53038674033147, 23.16455696202531
-226.7955801104972, 24.430379746835428
-223.4806629834254, 25.94936708860758
-214.0883977900552, 25.443037974683534
-211.878453038674, 27.215189873417707
-191.7127071823204, 27.974683544303787
-179.55801104972372, 27.215189873417707
-171.27071823204415, 27.215189873417707
-169.8895027624309, 28.481012658227833
-151.93370165745853, 28.987341772151886
-151.3812154696132, 30.759493670886066
-140.88397790055248, 31.77215189873416
-131.49171270718227, 33.29113924050632
-130.11049723756904, 31.012658227848092
-125.96685082872926, 31.51898734177214
-124.30939226519334, 28.73417721518986
-119.61325966850825, 29.240506329113913
-111.04972375690608, 31.51898734177214
-116.57458563535909, 59.62025316455694
-140.33149171270716, 68.98734177215188
-170.16574585635357, 71.01265822784809
-217.12707182320437, 68.73417721518986
-230.93922651933698, 57.59493670886074
-242.26519337016572, 40.63291139240505
-241.7127071823204, 30.253164556962012];

Lim_ST_Pacif = [-239.22651933701653, 22.40506329113923
-230.11049723756904, 24.177215189873408
-214.0883977900552, 25.189873417721508
-209.94475138121544, 27.72151898734176
-194.75138121546956, 28.227848101265806
-174.30939226519337, 27.974683544303787
-171.27071823204415, 27.72151898734176
-165.46961325966848, 29.493670886075932
-153.59116022099445, 28.73417721518986
-141.98895027624306, 32.02531645569619
-138.67403314917124, 34.05063291139239
-131.21546961325964, 33.797468354430364
-130.66298342541432, 32.27848101265822
-126.79558011049721, 31.51898734177214
-124.30939226519334, 29.493670886075932
-120.71823204419886, 29.240506329113913
-117.40331491712703, 25.94936708860758
-114.08839779005524, 21.392405063291122
-114.08839779005524, 19.873417721518976
-115.74585635359114, 16.83544303797467
-120.16574585635357, 15.06329113924049
-133.42541436464083, 15.569620253164544
-135.3591160220994, 14.810126582278471
-139.50276243093919, 12.784810126582272
-148.06629834254142, 10.253164556962005
-152.7624309392265, 9.240506329113913
-161.32596685082868, 8.22784810126582
-171.27071823204415, 7.215189873417714
-186.1878453038674, 5.189873417721515
-193.37016574585633, 3.6708860759493547
-200.2762430939226, 2.1518987341771947
-207.1823204419889, -0.37974683544304355
-214.64088397790053, 1.6455696202531556
-225.1381215469613, 4.683544303797447
-232.0441988950276, 5.189873417721515
-238.9502762430939, 15.316455696202524];

Lim_T_Pacif = [-207.1823204419889, -0.6329113924050773
-196.68508287292812, 2.4050632911392285
-188.9502762430939, 3.417721518987321
-179.55801104972372, 5.189873417721515
-168.78453038674033, 6.7088607594936605
-157.73480662983422, 8.48101265822784
-149.99999999999997, 9.240506329113913
-146.68508287292815, 10.759493670886059
-143.3701657458563, 11.012658227848092
-135.91160220994473, 13.037974683544292
-134.80662983425412, 15.316455696202524
-124.86187845303866, 15.316455696202524
-118.50828729281767, 15.316455696202524
-114.64088397790056, 18.35443037974683
-113.81215469613261, 22.151898734177202
-106.07734806629833, 20.632911392405056
-104.14364640883974, 17.594936708860743
-97.5138121546961, 15.316455696202524
-91.43646408839777, 15.06329113924049
-87.29281767955797, 11.518987341772132
-83.70165745856349, 9.999999999999986
-79.55801104972375, 8.48101265822784
-67.95580110497235, -0.37974683544304355
-63.53591160220992, -10.253164556962034
-64.6408839779005, -21.39240506329115
-64.91712707182319, -30.253164556962034
-72.9281767955801, -30.253164556962034
-80.3867403314917, -29.493670886075947
-80.3867403314917, -23.67088607594937
-81.21546961325964, -20.632911392405077
-86.18784530386739, -18.101265822784825
-99.44751381215468, -16.582278481012665
-101.93370165745853, -14.8101265822785
-117.67955801104972, -15.063291139240519
-122.9281767955801, -13.29113924050634
-137.0165745856353, -12.784810126582286
-137.292817679558, -11.51898734177216
-144.7513812154696, -11.01265822784812
-158.28729281767954, -8.227848101265835
-168.50828729281764, -6.962025316455708
-171.82320441988946, -5.696202531645582
-179.28176795580106, -4.936708860759509
-189.77900552486184, -3.4177215189873493
-195.8563535911602, -1.3924050632911644];

Lim_ST_SPacif = [-206.62983425414362, -1.3924050632911644
-195.58011049723754, -1.6455696202531698
-191.98895027624306, -3.924050632911417
-183.70165745856352, -4.177215189873422
-178.7292817679558, -4.6835443037974755
-172.09944751381212, -6.708860759493675
-161.32596685082868, -7.721518987341781
-154.41988950276243, -8.734177215189874
-148.06629834254142, -10
-143.09392265193367, -11.01265822784812
-137.0165745856353, -11.772151898734194
-135.08287292817676, -12.531645569620252
-127.34806629834253, -13.03797468354432
-122.09944751381212, -14.050632911392412
-114.64088397790056, -15.822784810126592
-100.55248618784526, -16.075949367088626
-96.68508287292815, -17.088607594936718
-86.74033149171271, -18.35443037974686
-82.59668508287291, -19.620253164556985
-80.110497237569, -24.430379746835456
-81.76795580110496, -29.24050632911394
-90.33149171270719, -30.506329113924068
-94.75138121546956, -33.54430379746836
-97.79005524861878, -34.05063291139241
-99.171270718232, -35.82278481012659
-108.28729281767949, -36.329113924050645
-126.2430939226519, -36.329113924050645
-141.1602209944751, -36.835443037974684
-153.86740331491708, -36.835443037974684
-162.43093922651929, -34.810126582278485
-166.57458563535909, -34.810126582278485
-170.4419889502762, -30.000000000000014
-179.55801104972372, -30.253164556962034
-181.76795580110493, -26.70886075949369
-186.46408839779002, -20.379746835443044
-191.7127071823204, -14.050632911392412
-194.1988950276243, -8.734177215189874
-202.2099447513812, -6.455696202531655];

Lim_T_Indian = [-328.1767955801105, -30.7594936708861
-324.585635359116, -30.506329113924068
-318.7845303867403, -30.7594936708861
-312.9834254143646, -31.26582278481014
-307.7348066298342, -31.26582278481014
-307.4585635359116, -29.24050632911394
-306.35359116022096, -26.96202531645571
-303.03867403314916, -25.443037974683563
-303.5911602209944, -23.16455696202533
-307.4585635359116, -22.405063291139243
-310.49723756906076, -19.620253164556985
-310.49723756906076, -15.569620253164572
-306.9060773480663, -14.556962025316466
-301.6574585635359, -14.556962025316466
-296.13259668508283, -14.8101265822785
-288.1215469613259, -13.797468354430407
-279.55801104972375, -14.050632911392412
-271.82320441988946, -14.050632911392412
-264.64088397790056, -14.050632911392412
-257.1823204419889, -15.063291139240519
-252.48618784530385, -17.59493670886077
-252.48618784530385, -21.39240506329115
-252.2099447513812, -26.96202531645571
-251.10497237569058, -28.481012658227854
-245.8563535911602, -28.481012658227854
-244.47513812154693, -28.734177215189888
-223.4806629834254, -30.506329113924068
-206.07734806629833, -30.253164556962034
-190.60773480662982, -30.000000000000014
-182.87292817679554, -30.000000000000014
-177.90055248618782, -30.000000000000014
-180.38674033149167, -26.455696202531655
-184.25414364640883, -22.151898734177237
-187.29281767955797, -17.341772151898738
-192.54143646408838, -12.784810126582286
-193.92265193370162, -10.253164556962034
-197.79005524861876, -7.215189873417742
-203.3149171270718, -5.949367088607616
-206.35359116022096, -3.1645569620253298
-213.53591160220992, -0.8860759493670969
-219.3370165745856, 1.6455696202531556
-223.20441988950273, 3.6708860759493547
-228.17679558011048, 4.177215189873408
-231.76795580110493, 4.177215189873408
-234.53038674033147, 7.974683544303787
-237.56906077348063, 14.556962025316437
-239.22651933701653, 19.873417721518976
-240.0552486187845, 24.177215189873408
-304.69613259668506, 32.53164556962024
-317.67955801104966, 31.51898734177214
-324.585635359116, 28.987341772151886
-325.96685082872926, 9.240506329113913
-328.72928176795574, -19.113924050632917];

Lim_ST_Indian = [-307.4585635359116, -30.506329113924068
-299.4475138121546, -30.7594936708861
-293.09392265193367, -30.000000000000014
-282.87292817679554, -30.000000000000014
-272.3756906077348, -30.000000000000014
-263.25966850828723, -29.74683544303798
-256.0773480662983, -29.493670886075947
-253.59116022099442, -28.987341772151908
-252.2099447513812, -26.202531645569636
-252.76243093922648, -21.39240506329115
-253.03867403314914, -18.607594936708864
-256.0773480662983, -16.075949367088626
-267.1270718232044, -13.797468354430407
-279.0055248618784, -14.556962025316466
-293.3701657458563, -14.556962025316466
-303.5911602209944, -14.556962025316466
-308.01104972375686, -14.556962025316466
-309.94475138121544, -15.822784810126592
-309.3922651933701, -19.36708860759495
-307.1823204419889, -21.64556962025317
-304.14364640883974, -22.151898734177237
-302.48618784530385, -24.177215189873436
-305.524861878453, -26.455696202531655];

Lim_NA = [-80.110497237569, 30.253164556962012
-59.66850828729281, 29.746835443037966
-59.66850828729281, 31.77215189873416
-30.110497237569064, 31.77215189873416
-29.281767955801058, 29.746835443037966
-10.497237569060758, 30.253164556962012
-8.83977900552486, 29.493670886075932
1.9337016574585846, 30.253164556962012
16.850828729281773, 25.94936708860758
27.624309392265275, 27.72151898734176
32.8729281767956, 39.113924050632896
28.729281767955797, 45.69620253164556
21.27071823204426, 60.63291139240505
9.392265193370179, 65.1898734177215
-12.430939226519286, 63.41772151898733
-62.70718232044197, 62.911392405063275
-76.51933701657453, 59.113924050632896
-83.14917127071823, 39.873417721518976];

Lim_ST_NAtl = [-77.62430939226516, 30.253164556962012
-66.57458563535909, 29.240506329113913
-59.66850828729281, 29.240506329113913
-60.22099447513807, 31.012658227848092
-40.331491712707134, 31.77215189873416
-30.662983425414325, 31.51898734177214
-28.729281767955797, 29.240506329113913
-21.546961325966834, 29.240506329113913
-20.441988950276198, 26.96202531645568
-27.0718232044199, 23.670886075949355
-32.59668508287291, 18.86075949367087
-35.911602209944704, 16.58227848101265
-38.67403314917124, 15.06329113924049
-47.5138121546961, 13.797468354430364
-51.6574585635359, 13.037974683544292
-53.038674033149164, 15.06329113924049
-53.59116022099448, 16.329113924050617
-69.06077348066293, 17.594936708860743
-74.585635359116, 21.898734177215182
-75.69060773480658, 25.443037974683534];

Lim_T_Atl = [-80.3867403314917, 27.215189873417707
-72.0994475138121, 19.113924050632903
-63.53591160220992, 18.86075949367087
-54.14364640883974, 17.08860759493669
-52.20994475138116, 15.06329113924049
-49.171270718231995, 13.291139240506311
-47.5138121546961, 14.050632911392398
-37.56906077348066, 14.050632911392398
-31.491712707182273, 21.139240506329102
-24.861878453038685, 24.177215189873408
-20.441988950276198, 26.455696202531634
-19.33701657458556, 29.240506329113913
-9.66850828729281, 29.493670886075932
7.734806629834338, 16.075949367088597
16.850828729281773, -8.987341772151908
19.060773480662988, -29.493670886075947
11.325966850828763, -28.987341772151908
1.3812154696133234, -28.734177215189888
2.762430939226533, -24.936708860759495
4.696132596685061, -22.405063291139243
-0.5524861878452612, -18.860759493670898
-8.287292817679486, -15.316455696202539
-4.9723756906076915, -10.506329113924068
-12.707182320441973, -7.468354430379762
-22.9281767955801, -7.215189873417742
-24.585635359115997, -5.696202531645582
-31.2154696132597, -5.443037974683548
-34.25414364640881, -3.924050632911417
-56.07734806629833, -2.6582278481012906
-72.0994475138121, 1.8987341772151751
-75.96685082872926, 7.468354430379733
-82.32044198895028, 8.48101265822784
-85.08287292817676, 12.531645569620238
-91.43646408839777, 15.06329113924049
-99.72375690607731, 17.594936708860743
-101.93370165745853, 36.32911392405062];

Lim_ST_SAtl = [-34.806629834254124, -6.708860759493675
-33.701657458563545, -4.430379746835456
-31.491712707182273, -5.949367088607616
-24.30939226519331, -5.443037974683548
-22.375690607734782, -7.721518987341781
-13.259668508287291, -7.215189873417742
-11.049723756906076, -8.227848101265835
-6.629834254143589, -10.253164556962034
-7.734806629834225, -14.556962025316466
-5.80110497237564, -16.582278481012665
0.5524861878453748, -18.860759493670898
2.209944751381215, -20.632911392405077
4.696132596685061, -22.658227848101276
1.104972375690636, -29.24050632911394
-7.1823204419889635, -30.253164556962034
-19.060773480662988, -30.253164556962034
-32.59668508287291, -29.24050632911394
-35.35911602209944, -26.70886075949369
-37.56906077348066, -22.151898734177237
-34.530386740331494, -18.35443037974686
-39.226519337016555, -15.316455696202539
-40.607734806629765, -10];

Lim_T_SAtl = [-33.977900552486176, -29.74683544303798
-37.56906077348066, -26.202531645569636
-37.56906077348066, -23.16455696202533
-34.530386740331494, -20.126582278481024
-36.18784530386739, -17.088607594936718
-38.397790055248606, -15.822784810126592
-45.02762430939225, -17.59493670886077
-53.038674033149164, -22.405063291139243
-54.69613259668506, -29.74683544303798
-42.81767955801104, -29.74683544303798];

Lim_SO = [-329.28176795580106, -30.506329113924068
-310.49723756906076, -31.012658227848107
-277.9005524861878, -31.772151898734194
-242.26519337016572, -30.000000000000014
-206.90607734806628, -30.253164556962034
-172.09944751381212, -31.26582278481014
-164.91712707182316, -35.56962025316456
-152.2099447513812, -35.56962025316456
-101.93370165745853, -37.34177215189874
-86.74033149171271, -30.253164556962034
-71.82320441988946, -29.24050632911394
-48.895027624309364, -29.74683544303798
18.784530386740357, -30.506329113924068
19.613259668508363, -61.392405063291164
-330.6629834254143, -61.392405063291164];

%% Create shapes of the different regions
sh_ST_Indian = polyshape(Lim_ST_Indian(:,1),Lim_ST_Indian(:,2));
sh_NA = polyshape(Lim_NA(:,1),Lim_NA(:,2));
sh_NP = polyshape(Lim_NP(:,1),Lim_NP(:,2));
sh_SO = polyshape(Lim_SO(:,1),Lim_SO(:,2));
sh_ST_NAtl = polyshape(Lim_ST_NAtl(:,1),Lim_ST_NAtl(:,2));
sh_ST_Pacif = polyshape(Lim_ST_Pacif(:,1),Lim_ST_Pacif(:,2));
sh_ST_SAtl = polyshape(Lim_ST_SAtl(:,1),Lim_ST_SAtl(:,2));
sh_ST_SPacif = polyshape(Lim_ST_SPacif(:,1),Lim_ST_SPacif(:,2));
sh_T_Atl = polyshape(Lim_T_Atl(:,1),Lim_T_Atl(:,2));
sh_T_Indian = polyshape(Lim_T_Indian(:,1),Lim_T_Indian(:,2));
sh_T_Pacif = polyshape(Lim_T_Pacif(:,1),Lim_T_Pacif(:,2));
sh_T_SAtl = polyshape(Lim_T_SAtl(:,1),Lim_T_SAtl(:,2));


%% Coord for the query points
lat_coord = -45:2:45; % -45:2:45;
long_coord = -180:2:178; % -180:2:170;

[XRUN, YRUN] = meshgrid(long_coord,lat_coord);
XRUN = mod(XRUN, 360);
XRUN(XRUN >30) = XRUN(XRUN>30)-360;

x = size(long_coord,2);
y = size(lat_coord,2);

XRUN = reshape(XRUN,x*y,1);
YRUN = reshape(YRUN,x*y,1);


%% Create masks

mask_NA = isinterior(sh_NA,XRUN,YRUN); mask_NA = reshape(mask_NA,y,x);
mask_NP = isinterior(sh_NP,XRUN,YRUN); mask_NP = reshape(mask_NP,y,x); 
mask_SO = isinterior(sh_SO,XRUN,YRUN); mask_SO = reshape(mask_SO,y,x);
mask_ST = isinterior(sh_ST_Indian,XRUN,YRUN)+...
          isinterior(sh_ST_NAtl,XRUN,YRUN)+...
          isinterior(sh_ST_Pacif,XRUN,YRUN)+...
          isinterior(sh_ST_SAtl,XRUN,YRUN)+...
          isinterior(sh_ST_SPacif,XRUN,YRUN); mask_ST = reshape(mask_ST,y,x); mask_ST(mask_NA+mask_NP+mask_SO>0) = 0;
      
mask_T  = isinterior(sh_T_Atl,XRUN,YRUN)+...
          isinterior(sh_T_Indian,XRUN,YRUN)+...
          isinterior(sh_T_Pacif,XRUN,YRUN)+...
          isinterior(sh_T_SAtl,XRUN,YRUN); mask_T = reshape(mask_T,y,x); mask_T(mask_T>1) = 1; mask_T(mask_NA+mask_NP+mask_SO+mask_ST>0) = 0;
      
XRUN = reshape(XRUN,y,x);
YRUN = reshape(YRUN,y,x);
mask_SO((YRUN<-28 & mask_ST==0) & mask_T==0) = 1;

save('Mask_geo.mat','mask_NA','mask_NP','mask_SO','mask_ST','mask_T')